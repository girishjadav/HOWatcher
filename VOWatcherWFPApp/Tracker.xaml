<Window x:Class="VOWatcherWFPApp.Tracker"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
       
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:VOWatcherWFPApp"
        mc:Ignorable="d"
        Title="Tracker" 
        WindowState="Maximized"
        WindowStartupLocation="CenterScreen"
        Loaded="Window_Loaded"
        SourceInitialized="Tracker_SourceInitialized"
        Activated="Tracker_Activated"
        Deactivated="Tracker_Deactivated"
                Icon="timetracker.ico" Height="795" Width="1941">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="250" />
            <ColumnDefinition Width="848*" />
            <ColumnDefinition Width="843*"/>
        </Grid.ColumnDefinitions>

        <!-- Sidebar -->
        <Grid Grid.Column="0" Background="#2E3440">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <!-- Logo Section -->
            <Border Grid.Row="0" Margin="10,10,10,5" CornerRadius="5">
                <Grid>
                    <Image Source="pack://application:,,,/logo.png" 
                           HorizontalAlignment="Center" 
                           VerticalAlignment="Center"
                           Stretch="Uniform"/>
                </Grid>
            </Border>

            <!-- Button Menu -->
            <StackPanel Grid.Row="1" Margin="10">
                <Button x:Name="btnLogin"
        Content="Login"
        Height="40"
        Margin="0,5"
        Background="#4C566A"
        Foreground="White"
        BorderThickness="0"
        Style="{DynamicResource SidebarButtonStyle}"
        Click="LoginButton_Click" />

                <Button Content="Add Task" 
                        Height="40" 
                        Margin="0,5" 
                        Background="#4C566A" 
                        Foreground="White"
                        BorderThickness="0"
                        Style="{DynamicResource SidebarButtonStyle}" Click="Button_Click"  />
                <Button Content="My Task" 
                        Height="40" 
                        Margin="0,5" 
                        Background="#4C566A" 
                        Foreground="White"
                        BorderThickness="0"
                        Style="{DynamicResource SidebarButtonStyle}"  Click="MyTaskButton_Click"/>
                <Button Content="Settings" 
                        Height="40" 
                        Margin="0,5" 
                        Background="#4C566A" 
                        Foreground="White"
                        BorderThickness="0"
                        Style="{DynamicResource SidebarButtonStyle}"/>
            </StackPanel>

            <!-- Calendar and Label Container -->
            <Grid Grid.Row="2">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <Label Grid.Row="0" Name="label3" 
                       Foreground="White" 
                       Margin="10"
                       FontWeight="Bold"
                       HorizontalAlignment="Center"
                       HorizontalContentAlignment="Center"/>
                <StackPanel Grid.Row="1" Margin="10,5,10,10" VerticalAlignment="Top">
                    <!-- Calendar -->
                    <Calendar x:Name="monthCalendar1"
              Background="White"  
              Foreground="#3B4252"
              CalendarDayButtonStyle="{DynamicResource CalendarDayButtonStyle}"/>

                    <Border BorderBrush="Black" BorderThickness="1" Padding="5" Background="#ECEFF4" Margin="0,10,0,0">
                        <StackPanel>
                            <TextBlock Text="Attendance" FontWeight="Bold" Margin="0,0,0,5" />
                            <Border BorderBrush="Black" BorderThickness="1" Padding="5" Background="#ECEFF4" Margin="10">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="1"/>
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>

                                    <!-- Analog Clock -->
                                    <Canvas Width="50" Height="50" Grid.Column="0" HorizontalAlignment="Center" VerticalAlignment="Center">
                                        <Ellipse Stroke="Black" Width="50" Height="50"/>
                                        <Line x:Name="hourHand" X1="25" Y1="25" X2="25" Y2="15" Stroke="Black" StrokeThickness="2"/>
                                        <Line x:Name="minuteHand" X1="25" Y1="25" X2="35" Y2="25" Stroke="Black" StrokeThickness="1"/>
                                    </Canvas>

                                    <!-- Vertical Separator -->
                                    <Border Grid.Column="2" Background="black" Width="2" Margin="4,-1,129,0"/>

                                    <!-- Button + Current Time -->
                                    <StackPanel Grid.Column="2" VerticalAlignment="Center" Margin="10,0,0,0">
                                        <Button x:Name="CheckInOutButton"
                    Content="Check-in"
                    FontWeight="Bold"
                    FontSize="14"
                    Padding="5"
                    Background="Transparent"
                    BorderThickness="2"
                    Click="CheckInOutButton_Click"/>
                                        <TextBlock x:Name="txtCheckinTime"
                       Text="00:00:00"
                       FontWeight="Bold"
                       FontSize="14"
                       Foreground="Black"
                       HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Grid>
                            </Border>



                            <TextBlock x:Name="lblcheckin" Text="00:00:00" FontWeight="Bold"
           FontSize="14" HorizontalAlignment="Center" Margin="0,5"/>
                            <TextBlock x:Name="lblcheckinT" Text="yet not check in" 
           Foreground="Red" FontWeight="Bold" FontSize="14" 
           HorizontalAlignment="Center" Margin="0,5"/>


                        </StackPanel>
                    </Border>

                </StackPanel>
            </Grid>
        </Grid>


        <!-- Main Content Area with DataGrid and Summary -->
        <Grid Grid.Column="1" Background="#ECEFF4" Grid.ColumnSpan="2">
            <!-- Tracker View -->
            <Grid x:Name="TrackerPanel" Visibility="Visible">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>





                <Border Grid.Row="0" Background="#ECEFF4" Padding="10,10,10,0" Margin="10,10,10,0">
                    <TextBlock Text="Tracker Log" FontSize="26" FontWeight="SemiBold" />
                </Border>

                <!-- DataGrid -->
                <Border Background="#D8DEE9" Margin="0,3,0,0" Padding="5,0,5,5" Grid.Row="1" Height="358" VerticalAlignment="Top">
                    <DataGrid x:Name="dataGridView2"
                    Margin="10,10,10,31"
                    AutoGenerateColumns="False"
                    IsReadOnly="True"
                    AlternatingRowBackground="#E5E9F0"
                    RowBackground="White"
                    GridLinesVisibility="Horizontal"
                    HorizontalGridLinesBrush="LightGray"
                    HeadersVisibility="Column"
                    BorderThickness="0"
                    BorderBrush="#D8DEE9"
                    CanUserResizeColumns="True"
                    CanUserSortColumns="True"
                    MouseRightButtonUp="dataGridView2_MouseRightButtonUp"
                    VerticalScrollBarVisibility="Visible" SelectionChanged="dataGridView2_SelectionChanged">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Application" Binding="{Binding processname}" Width="628"/>
                            <DataGridTextColumn Header="Start Time" Binding="{Binding starttime}" Width="100"/>
                            <DataGridTextColumn Header="End Time" Binding="{Binding endtime}" Width="100"/>
                            <DataGridTextColumn Header="Total Time" Binding="{Binding totaltimesecounds}" Width="80"/>
                            <DataGridTextColumn Header="Idle Time" Binding="{Binding idletimesecounds}" Width="80"/>
                            <DataGridTextColumn Header="Actual Time" Binding="{Binding actualsecounds}" Width="80"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Border>

                <!-- Tracker Summary -->
                <Border Grid.Row="1" Background="#D8DEE9" Padding="15" VerticalAlignment="Top" Height="253" Margin="0,353,0,0" Grid.RowSpan="2">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="932*"/>
                            <ColumnDefinition Width="729*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" 
                        Text="Tracker Summary" 
                        FontSize="18" 
                        FontWeight="SemiBold" 
                        Margin="0,0,0,10" Grid.ColumnSpan="2"/>

                        <DataGrid x:Name="dataGridView1"
                        Grid.Row="1"
                        AutoGenerateColumns="False"
                        IsReadOnly="True"
                        Height="179"
                        AlternatingRowBackground="#E5E9F0"
                        RowBackground="White"
                        GridLinesVisibility="Horizontal"
                        HorizontalGridLinesBrush="LightGray"
                        HeadersVisibility="Column"
                        BorderThickness="0"
                        BorderBrush="#D8DEE9"
                        CanUserResizeColumns="True"
                        VerticalScrollBarVisibility="Visible" VerticalAlignment="Center" Grid.ColumnSpan="2">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Application" Binding="{Binding processname}" Width="*"/>
                                <DataGridTextColumn Header="Total Time" Binding="{Binding totaltimesecounds}" Width="80"/>
                                <DataGridTextColumn Header="Idle Time" Binding="{Binding idletimesecounds}" Width="80"/>
                                <DataGridTextColumn Header="Actual Time" Binding="{Binding actualsecounds}" Width="80"/>
                            </DataGrid.Columns>
                        </DataGrid>

                    </Grid>


                </Border>
                <!-- Bottom Timer Section -->
                <Border Grid.Row="2" Background="#D8DEE9" Padding="15" Margin="0,41,0,-3">
                    <Grid Margin="-5,-38,5,-15">
                        <Grid Margin="20,22,0,19">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <!-- Timer Centered -->
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,10,0,0">
                                <!-- Time Blocks -->
                                <Border Background="Black" CornerRadius="6" Padding="6" Margin="2" Height="56">
                                    <StackPanel>
                                        <TextBlock x:Name="txtHours" Text="00" FontSize="20" FontWeight="Bold" Foreground="White" HorizontalAlignment="Center"/>
                                        <TextBlock Text="HRS" FontSize="10" Foreground="White" HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Border>
                                <Border Background="Black" CornerRadius="6" Padding="6" Margin="2" Height="56">
                                    <StackPanel>
                                        <TextBlock x:Name="txtMinutes" Text="00" FontSize="20" FontWeight="Bold" Foreground="White" HorizontalAlignment="Center"/>
                                        <TextBlock Text="MIN" FontSize="10" Foreground="White" HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Border>
                                <Border Background="Black" CornerRadius="6" Padding="6" Margin="2" Height="56">
                                    <StackPanel>
                                        <TextBlock x:Name="txtSeconds" Text="00" FontSize="20" FontWeight="Bold" Foreground="White" HorizontalAlignment="Center"/>
                                        <TextBlock Text="SEC" FontSize="10" Foreground="White" HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Border>
                                <!-- Button -->
                                <Button x:Name="btnStartStop" Width="60" Height="60" Click="btnStartStop_Click" Margin="10">
                                    <Image x:Name="imgStartStop" Source="start.png" Width="50" Height="50" Stretch="Uniform"/>
                                </Button>
                            </StackPanel>
                            
                            <!-- Box at Bottom Right -->
                            <Border Grid.Column="1" Background="#EFEFEF" BorderBrush="Gray" BorderThickness="1" Padding="10" CornerRadius="6" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="56,0,0,0" Width="208">
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                        <TextBlock Text="Start Time: " FontWeight="Bold" VerticalAlignment="Center"/>
                                        <TextBlock x:Name="txtStartTime" Text="--:--:--" VerticalAlignment="Center" Foreground="Black"/>
                                    </StackPanel>
                                    
                                        <StackPanel Orientation="Horizontal" MaxWidth="300">
                                            <TextBlock Text="Task: " FontWeight="Bold" VerticalAlignment="Top" Margin="0,0,5,0"/>
                                            <ScrollViewer VerticalScrollBarVisibility="Auto" Height="40" Width="147">
                                                <TextBlock x:Name="txtTaskName"
                   Text="--"
                   VerticalAlignment="Top"
                   TextWrapping="Wrap"
                   Foreground="Black"/>
                                            </ScrollViewer>
                                        </StackPanel>

                                    </StackPanel>
                            </Border>
                        </Grid>
                    </Grid>
                </Border>


            </Grid>


            <!-- MyTask View -->
            <Grid x:Name="MyTaskPanel" Visibility="Collapsed">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Header with Title and Close Button -->
                <Border Grid.Row="0" Background="#D8DEE9" Padding="15,15,15,0">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Text="My Tasks" FontSize="18" FontWeight="SemiBold" VerticalAlignment="Center"/>

                        <Button Content="✕"
                    Grid.Column="1"
                    Width="30" Height="30"
                    Margin="5"
                    ToolTip="Close"
                    Background="Red"
                    Foreground="White"
                    FontWeight="Bold"
                    Click="CloseMyTaskPanel_Click"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Top"/>
                    </Grid>
                </Border>

                <!-- DataGrid -->
                <Border Grid.Row="1" Background="#D8DEE9" Margin="0" Padding="5,0,5,5">
                    <DataGrid x:Name="taskDataGrid"
                  Margin="10"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  AlternatingRowBackground="#E5E9F0"
                  RowBackground="White"
                  GridLinesVisibility="Horizontal"
                  HeadersVisibility="Column"
                  BorderThickness="0"
                  BorderBrush="#D8DEE9"
                  SelectionChanged="taskDataGrid_SelectionChanged">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Assigned By" Binding="{Binding AccountablePerson}" Width="120"/>
                            <DataGridTextColumn Header="Assigned Date" Binding="{Binding AssignDate, StringFormat=dd/MM/yyyy}" Width="100"/>
                            <DataGridTextColumn Header="Due Date" Binding="{Binding ETA, StringFormat=dd/MM/yyyy}" Width="100"/>
                            <DataGridTextColumn Header="Project" Binding="{Binding Project}" Width="120"/>
                            <DataGridTextColumn Header="SubProject" Binding="{Binding SubProject}" Width="120"/>
                            <DataGridTemplateColumn Header="Task" Width="195">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Priority}"
                       TextWrapping="Wrap"
                       VerticalAlignment="Center"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTextColumn Header="Status" Binding="{Binding Completed}" Width="80"/>
                            <DataGridTemplateColumn Header="Action" Width="100">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Button x:Name="btnStartStop" Content="{Binding ButtonContent}" Click="btnStartStops_Click" Width="70" Height="25"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>


                            <DataGridTextColumn Header="Projected" Binding="{Binding ETAFormatted}" Width="80"/>
                            <DataGridTextColumn Header="Actual" Binding="{Binding Duration}" Width="80"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Border>
            </Grid>

        </Grid>
    </Grid>


    <Window.Resources>
        <x:Array Type="sys:String" x:Key="StatusList"
             xmlns:sys="clr-namespace:System;assembly=mscorlib">
            <sys:String>Not Started</sys:String>
            <sys:String>In Progress</sys:String>
            <sys:String>Done</sys:String>

        </x:Array>

        <Style x:Key="SidebarButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#4C566A"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="ButtonBorder" 
                                Background="{TemplateBinding Background}" 
                                CornerRadius="5"
                                BorderThickness="0">
                            <ContentPresenter HorizontalAlignment="Center" 
                                            VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="ButtonBorder" Property="Background" Value="#5E81AC"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="ButtonBorder" Property="Background" Value="#81A1C1"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="CalendarDayButtonStyle" TargetType="CalendarDayButton">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Background" Value="Transparent"/>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#5E81AC"/>
                </Trigger>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#81A1C1"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style TargetType="DataGridRow">
            <Setter Property="Margin" Value="0"/>
        </Style>

        <Style TargetType="DataGrid">
            <Setter Property="RowHeaderWidth" Value="0"/>
        </Style>
        <Style TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#4C566A"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="BorderThickness" Value="0,0,1,0"/>
            <Setter Property="BorderBrush" Value="#3B4252"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
        </Style>
    </Window.Resources>
</Window>